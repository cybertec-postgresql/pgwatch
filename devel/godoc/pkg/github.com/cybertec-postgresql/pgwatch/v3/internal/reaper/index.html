<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="#375EAB">

  <title>reaper - GoPages</title>

<link type="text/css" rel="stylesheet" href="/devel/godoc/lib/godoc/style.css">

<script>window.initFuncs = [];</script>
<script src="/devel/godoc/lib/godoc/jquery.js" defer></script>




<script>var goVersion = "go1.25.1";</script>
<script src="/devel/godoc/lib/godoc/godocs.js" defer></script>

</head>
<body>

<div id='lowframe' style="position: fixed; bottom: 0; left: 0; height: 0; width: 100%; border-top: thin solid grey; background-color: white; overflow: auto;">
...
</div><!-- #lowframe -->

<div id="topbar" class="wide"><div class="container">
<div class="top-heading" id="heading-wide"><a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/">GoPages | Auto-generated docs</a></div>
<div class="top-heading" id="heading-narrow"><a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/">GoPages</a></div>
<a href="#" id="menu-button"><span id="menu-button-arrow">&#9661;</span></a>

</div></div>



<div id="page" class="wide">
<div class="container">


  <h1>
    Package reaper
    <span class="text-muted"></span>
  </h1>







<div id="nav"></div>


<!--
	Copyright 2009 The Go Authors. All rights reserved.
	Use of this source code is governed by a BSD-style
	license that can be found in the LICENSE file.
-->
<!--
	Note: Static (i.e., not template-generated) href and id
	attributes start with "pkg-" to make it impossible for
	them to conflict with generated attributes (some of which
	correspond to Go identifiers).
-->

	<script>
	document.ANALYSIS_DATA = null;
	document.CALLGRAPH = null;
	</script>

	
		
		<div id="short-nav">
			<dl>
			<dd><code>import "github.com/cybertec-postgresql/pgwatch/v3/internal/reaper"</code></dd>
			</dl>
			<dl>
			<dd><a href="#pkg-overview" class="overviewLink">Overview</a></dd>
			<dd><a href="#pkg-index" class="indexLink">Index</a></dd>
			
			
			</dl>
		</div>
		<!-- The package's Name is printed as title by the top-level template -->
		<div id="pkg-overview" class="toggleVisible">
			<div class="collapsed">
				<h2 class="toggleButton" title="Click to show Overview section">Overview ▹</h2>
			</div>
			<div class="expanded">
				<h2 class="toggleButton" title="Click to hide Overview section">Overview ▾</h2>
				<p>Package reaper is responsible to query the metrics from monitored sources
and send measurements to sinks.

				
			</div>
		</div>

		<div id="pkg-index" class="toggleVisible">
		<div class="collapsed">
			<h2 class="toggleButton" title="Click to show Index section">Index ▹</h2>
		</div>
		<div class="expanded">
			<h2 class="toggleButton" title="Click to hide Index section">Index ▾</h2>

		<!-- Table of contents for API; must be named manual-nav to turn off auto nav. -->
			<div id="manual-nav">
			<dl>
			
				<dd><a href="#pkg-constants">Constants</a></dd>
			
			
				<dd><a href="#pkg-variables">Variables</a></dd>
			
			
				
				<dd><a href="#CheckFolderExistsAndReadable">func CheckFolderExistsAndReadable(path string) bool</a></dd>
			
				
				<dd><a href="#DoesEmergencyTriggerfileExist">func DoesEmergencyTriggerfileExist(fname string) bool</a></dd>
			
				
				<dd><a href="#GetGoPsutilCPU">func GetGoPsutilCPU(interval float64) ([]map[string]any, error)</a></dd>
			
				
				<dd><a href="#GetGoPsutilDiskPG">func GetGoPsutilDiskPG(DataDirs, TblspaceDirs []map[string]any) ([]map[string]any, error)</a></dd>
			
				
				<dd><a href="#GetGoPsutilDiskTotals">func GetGoPsutilDiskTotals() ([]map[string]any, error)</a></dd>
			
				
				<dd><a href="#GetGoPsutilMem">func GetGoPsutilMem() ([]map[string]any, error)</a></dd>
			
				
				<dd><a href="#GetLoadAvgLocal">func GetLoadAvgLocal() ([]map[string]any, error)</a></dd>
			
				
				<dd><a href="#GetPathUnderlyingDeviceID">func GetPathUnderlyingDeviceID(path string) (uint64, error)</a></dd>
			
				
				<dd><a href="#IsDirectlyFetchableMetric">func IsDirectlyFetchableMetric(metric string) bool</a></dd>
			
				
				<dd><a href="#QueryMeasurements">func QueryMeasurements(ctx context.Context, md *sources.SourceConn, sql string, args ...any) (metrics.Measurements, error)</a></dd>
			
				
				<dd><a href="#TryCreateMetricsFetchingHelpers">func TryCreateMetricsFetchingHelpers(ctx context.Context, md *sources.SourceConn) (err error)</a></dd>
			
				
				<dd><a href="#TryCreateMissingExtensions">func TryCreateMissingExtensions(ctx context.Context, md *sources.SourceConn, extensionNames []string, existingExtensions map[string]int) []string</a></dd>
			
				
				<dd><a href="#goPsutilCalcCPUUtilization">func goPsutilCalcCPUUtilization(probe0, probe1 cpu.TimesStat) float64</a></dd>
			
			
				
				<dd><a href="#ChangeDetectionResults">type ChangeDetectionResults</a></dd>
				
				
					
					<dd>&nbsp; &nbsp; <a href="#ChangeDetectionResults.String">func (cdr *ChangeDetectionResults) String() string</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#ChangeDetectionResults.Total">func (cdr *ChangeDetectionResults) Total() int</a></dd>
				
			
				
				<dd><a href="#ConcurrentMetricDefs">type ConcurrentMetricDefs</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#NewConcurrentMetricDefs">func NewConcurrentMetricDefs() *ConcurrentMetricDefs</a></dd>
				
				
					
					<dd>&nbsp; &nbsp; <a href="#ConcurrentMetricDefs.Assign">func (cmd *ConcurrentMetricDefs) Assign(newDefs *metrics.Metrics)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#ConcurrentMetricDefs.GetMetricDef">func (cmd *ConcurrentMetricDefs) GetMetricDef(name string) (m metrics.Metric, ok bool)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#ConcurrentMetricDefs.GetPresetDef">func (cmd *ConcurrentMetricDefs) GetPresetDef(name string) (m metrics.Preset, ok bool)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#ConcurrentMetricDefs.GetPresetMetrics">func (cmd *ConcurrentMetricDefs) GetPresetMetrics(name string) (m map[string]float64)</a></dd>
				
			
				
				<dd><a href="#ExistingPartitionInfo">type ExistingPartitionInfo</a></dd>
				
				
			
				
				<dd><a href="#InstanceMetricCache">type InstanceMetricCache</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#NewInstanceMetricCache">func NewInstanceMetricCache() *InstanceMetricCache</a></dd>
				
				
					
					<dd>&nbsp; &nbsp; <a href="#InstanceMetricCache.Get">func (imc *InstanceMetricCache) Get(key string, age time.Duration) metrics.Measurements</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#InstanceMetricCache.Put">func (imc *InstanceMetricCache) Put(key string, data metrics.Measurements)</a></dd>
				
			
				
				<dd><a href="#Reaper">type Reaper</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#NewReaper">func NewReaper(ctx context.Context, opts *cmdopts.Options) (r *Reaper)</a></dd>
				
				
					
					<dd>&nbsp; &nbsp; <a href="#Reaper.AddSysinfoToMeasurements">func (r *Reaper) AddSysinfoToMeasurements(data metrics.Measurements, md *sources.SourceConn)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#Reaper.CloseResourcesForRemovedMonitoredDBs">func (r *Reaper) CloseResourcesForRemovedMonitoredDBs(shutDownDueToRoleChange map[string]bool)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#Reaper.CreateSourceHelpers">func (r *Reaper) CreateSourceHelpers(ctx context.Context, srcL log.Logger, monitoredSource *sources.SourceConn)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#Reaper.DetectConfigurationChanges">func (r *Reaper) DetectConfigurationChanges(ctx context.Context, md *sources.SourceConn) ChangeDetectionResults</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#Reaper.DetectIndexChanges">func (r *Reaper) DetectIndexChanges(ctx context.Context, md *sources.SourceConn) ChangeDetectionResults</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#Reaper.DetectPrivilegeChanges">func (r *Reaper) DetectPrivilegeChanges(ctx context.Context, md *sources.SourceConn) ChangeDetectionResults</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#Reaper.DetectSprocChanges">func (r *Reaper) DetectSprocChanges(ctx context.Context, md *sources.SourceConn) (changeCounts ChangeDetectionResults)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#Reaper.DetectTableChanges">func (r *Reaper) DetectTableChanges(ctx context.Context, md *sources.SourceConn) ChangeDetectionResults</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#Reaper.FetchMetric">func (r *Reaper) FetchMetric(ctx context.Context, md *sources.SourceConn, metricName string) (_ *metrics.MeasurementEnvelope, err error)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#Reaper.FetchStatsDirectlyFromOS">func (r *Reaper) FetchStatsDirectlyFromOS(ctx context.Context, md *sources.SourceConn, metricName string) (*metrics.MeasurementEnvelope, error)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#Reaper.GetInstanceUpMeasurement">func (r *Reaper) GetInstanceUpMeasurement(ctx context.Context, md *sources.SourceConn) (metrics.Measurements, error)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#Reaper.GetObjectChangesMeasurement">func (r *Reaper) GetObjectChangesMeasurement(ctx context.Context, md *sources.SourceConn) (metrics.Measurements, error)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#Reaper.LoadMetrics">func (r *Reaper) LoadMetrics() (err error)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#Reaper.LoadSources">func (r *Reaper) LoadSources() (err error)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#Reaper.PrintMemStats">func (r *Reaper) PrintMemStats()</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#Reaper.Ready">func (r *Reaper) Ready() bool</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#Reaper.Reap">func (r *Reaper) Reap(ctx context.Context)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#Reaper.ShutdownOldWorkers">func (r *Reaper) ShutdownOldWorkers(ctx context.Context, hostsToShutDownDueToRoleChange map[string]bool)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#Reaper.WriteMeasurements">func (r *Reaper) WriteMeasurements(ctx context.Context)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#Reaper.WriteMonitoredSources">func (r *Reaper) WriteMonitoredSources(ctx context.Context)</a></dd>
				
					
					<dd>&nbsp; &nbsp; <a href="#Reaper.reapMetricMeasurements">func (r *Reaper) reapMetricMeasurements(ctx context.Context, md *sources.SourceConn, metricName string)</a></dd>
				
			
			
			</dl>
			</div><!-- #manual-nav -->

		

		
			<h3>Package files</h3>
			<p>
			<span style="font-size:90%">
			
				<a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/cache.go.html">cache.go</a>
			
				<a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/database.go.html">database.go</a>
			
				<a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/doc.go.html">doc.go</a>
			
				<a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/file.go.html">file.go</a>
			
				<a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/metric.go.html">metric.go</a>
			
				<a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/psutil.go.html">psutil.go</a>
			
				<a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/psutil_linux.go.html">psutil_linux.go</a>
			
				<a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/reaper.go.html">reaper.go</a>
			
			</span>
			</p>
		
		</div><!-- .expanded -->
		</div><!-- #pkg-index -->

		

		
			<h2 id="pkg-constants">Constants</h2>
			
				
				<pre>const (
    <span id="metricCPULoad">metricCPULoad</span>           = &#34;cpu_load&#34;
    <span id="metricPsutilCPU">metricPsutilCPU</span>         = &#34;psutil_cpu&#34;
    <span id="metricPsutilDisk">metricPsutilDisk</span>        = &#34;psutil_disk&#34;
    <span id="metricPsutilDiskIoTotal">metricPsutilDiskIoTotal</span> = &#34;psutil_disk_io_total&#34;
    <span id="metricPsutilMem">metricPsutilMem</span>         = &#34;psutil_mem&#34;
)</pre>
			
				
				<pre>const (
    <span id="sqlPgDirs">sqlPgDirs</span> = `select current_setting(&#39;data_directory&#39;) as dd, current_setting(&#39;log_directory&#39;) as ld`
    <span id="sqlTsDirs">sqlTsDirs</span> = `select spcname::text as name, pg_catalog.pg_tablespace_location(oid) as location from pg_catalog.pg_tablespace where not spcname like any(array[E&#39;pg\\_%&#39;])`
)</pre>
			
				
				<pre>const (
    <span id="monitoredDbsDatastoreSyncIntervalSeconds">monitoredDbsDatastoreSyncIntervalSeconds</span> = 600              <span class="comment">// write actively monitored DBs listing to metrics store after so many seconds</span>
    <span id="monitoredDbsDatastoreSyncMetricName">monitoredDbsDatastoreSyncMetricName</span>      = &#34;configured_dbs&#34; <span class="comment">// FYI - for Postgres datastore there&#39;s also the admin.all_unique_dbnames table with all recent DB unique names with some metric data</span>
    <span id="dbMetricJoinStr">dbMetricJoinStr</span>                          = &#34;¤¤¤&#34;            <span class="comment">// just some unlikely string for a DB name to avoid using maps of maps for DB+metric data</span>

)</pre>
			
				
				<pre>const (
    <span id="specialMetricChangeEvents">specialMetricChangeEvents</span>         = &#34;change_events&#34;
    <span id="specialMetricServerLogEventCounts">specialMetricServerLogEventCounts</span> = &#34;server_log_event_counts&#34;
    <span id="specialMetricInstanceUp">specialMetricInstanceUp</span>           = &#34;instance_up&#34;
)</pre>
			
		
		
			<h2 id="pkg-variables">Variables</h2>
			
				
				<pre>var <span id="directlyFetchableOSMetrics">directlyFetchableOSMetrics</span> = []<a href="https://pkg.go.dev/builtin/#string">string</a>{metricPsutilCPU, metricPsutilDisk, metricPsutilDiskIoTotal, metricPsutilMem, metricCPULoad}</pre>
			
				
				<pre>var <span id="hostLastKnownStatusInRecovery">hostLastKnownStatusInRecovery</span> = <a href="https://pkg.go.dev/builtin/#make">make</a>(map[<a href="https://pkg.go.dev/builtin/#string">string</a>]<a href="https://pkg.go.dev/builtin/#bool">bool</a>) <span class="comment">// isInRecovery</span>
</pre>
			
				
				<pre>var <span id="lastSQLFetchError">lastSQLFetchError</span> <a href="https://pkg.go.dev/sync/">sync</a>.<a href="https://pkg.go.dev/sync/#Map">Map</a></pre>
			
				
				<pre>var <span id="metricDefs">metricDefs</span> = <a href="#NewConcurrentMetricDefs">NewConcurrentMetricDefs</a>()</pre>
			
				
				<pre>var <span id="metricsConfig">metricsConfig</span> map[<a href="https://pkg.go.dev/builtin/#string">string</a>]<a href="https://pkg.go.dev/builtin/#float64">float64</a> <span class="comment">// set to host.Metrics or host.MetricsStandby (in case optional config defined and in recovery state</span>
</pre>
			
				
				<pre>var <span id="prevCPULoadTimeStats">prevCPULoadTimeStats</span> <a href="https://pkg.go.dev/github.com/shirou/gopsutil/v4/cpu/">cpu</a>.<a href="https://pkg.go.dev/github.com/shirou/gopsutil/v4/cpu/#TimesStat">TimesStat</a></pre>
			
				<p>&quot;cache&quot; of last CPU utilization stats for GetGoPsutilCPU to get more exact results and not having to sleep

				<pre>var <span id="prevCPULoadTimeStatsLock">prevCPULoadTimeStatsLock</span> <a href="https://pkg.go.dev/sync/">sync</a>.<a href="https://pkg.go.dev/sync/#RWMutex">RWMutex</a></pre>
			
				
				<pre>var <span id="prevCPULoadTimestamp">prevCPULoadTimestamp</span> <a href="https://pkg.go.dev/time/">time</a>.<a href="https://pkg.go.dev/time/#Time">Time</a></pre>
			
				
				<pre>var <span id="specialMetrics">specialMetrics</span> = map[<a href="https://pkg.go.dev/builtin/#string">string</a>]<a href="https://pkg.go.dev/builtin/#bool">bool</a>{specialMetricChangeEvents: <a href="https://pkg.go.dev/builtin/#true">true</a>, specialMetricServerLogEventCounts: <a href="https://pkg.go.dev/builtin/#true">true</a>}</pre>
			
		
		
			
			
			<h2 id="CheckFolderExistsAndReadable">func <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/psutil.go.html#L139">CheckFolderExistsAndReadable</a>
				<a class="permalink" href="#CheckFolderExistsAndReadable">&#xb6;</a>
				
				
			</h2>
			<pre>func CheckFolderExistsAndReadable(path <a href="https://pkg.go.dev/builtin/#string">string</a>) <a href="https://pkg.go.dev/builtin/#bool">bool</a></pre>
			
			
			

		
			
			
			<h2 id="DoesEmergencyTriggerfileExist">func <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/file.go.html#L13">DoesEmergencyTriggerfileExist</a>
				<a class="permalink" href="#DoesEmergencyTriggerfileExist">&#xb6;</a>
				
				
			</h2>
			<pre>func DoesEmergencyTriggerfileExist(fname <a href="https://pkg.go.dev/builtin/#string">string</a>) <a href="https://pkg.go.dev/builtin/#bool">bool</a></pre>
			
			
			

		
			
			
			<h2 id="GetGoPsutilCPU">func <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/psutil.go.html#L28">GetGoPsutilCPU</a>
				<a class="permalink" href="#GetGoPsutilCPU">&#xb6;</a>
				
				
			</h2>
			<pre>func GetGoPsutilCPU(interval <a href="https://pkg.go.dev/builtin/#float64">float64</a>) ([]map[<a href="https://pkg.go.dev/builtin/#string">string</a>]<a href="https://pkg.go.dev/builtin/#any">any</a>, <a href="https://pkg.go.dev/builtin/#error">error</a>)</pre>
			<p>Simulates &quot;psutil&quot; metric output. Assumes the result from last call as input, otherwise uses a 1s measurement

			
			

		
			
			
			<h2 id="GetGoPsutilDiskPG">func <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/psutil.go.html#L144">GetGoPsutilDiskPG</a>
				<a class="permalink" href="#GetGoPsutilDiskPG">&#xb6;</a>
				
				
			</h2>
			<pre>func GetGoPsutilDiskPG(DataDirs, TblspaceDirs []map[<a href="https://pkg.go.dev/builtin/#string">string</a>]<a href="https://pkg.go.dev/builtin/#any">any</a>) ([]map[<a href="https://pkg.go.dev/builtin/#string">string</a>]<a href="https://pkg.go.dev/builtin/#any">any</a>, <a href="https://pkg.go.dev/builtin/#error">error</a>)</pre>
			
			
			

		
			
			
			<h2 id="GetGoPsutilDiskTotals">func <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/psutil.go.html#L101">GetGoPsutilDiskTotals</a>
				<a class="permalink" href="#GetGoPsutilDiskTotals">&#xb6;</a>
				
				
			</h2>
			<pre>func GetGoPsutilDiskTotals() ([]map[<a href="https://pkg.go.dev/builtin/#string">string</a>]<a href="https://pkg.go.dev/builtin/#any">any</a>, <a href="https://pkg.go.dev/builtin/#error">error</a>)</pre>
			
			
			

		
			
			
			<h2 id="GetGoPsutilMem">func <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/psutil.go.html#L80">GetGoPsutilMem</a>
				<a class="permalink" href="#GetGoPsutilMem">&#xb6;</a>
				
				
			</h2>
			<pre>func GetGoPsutilMem() ([]map[<a href="https://pkg.go.dev/builtin/#string">string</a>]<a href="https://pkg.go.dev/builtin/#any">any</a>, <a href="https://pkg.go.dev/builtin/#error">error</a>)</pre>
			
			
			

		
			
			
			<h2 id="GetLoadAvgLocal">func <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/psutil.go.html#L125">GetLoadAvgLocal</a>
				<a class="permalink" href="#GetLoadAvgLocal">&#xb6;</a>
				
				
			</h2>
			<pre>func GetLoadAvgLocal() ([]map[<a href="https://pkg.go.dev/builtin/#string">string</a>]<a href="https://pkg.go.dev/builtin/#any">any</a>, <a href="https://pkg.go.dev/builtin/#error">error</a>)</pre>
			
			
			

		
			
			
			<h2 id="GetPathUnderlyingDeviceID">func <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/psutil_linux.go.html#L8">GetPathUnderlyingDeviceID</a>
				<a class="permalink" href="#GetPathUnderlyingDeviceID">&#xb6;</a>
				
				
			</h2>
			<pre>func GetPathUnderlyingDeviceID(path <a href="https://pkg.go.dev/builtin/#string">string</a>) (<a href="https://pkg.go.dev/builtin/#uint64">uint64</a>, <a href="https://pkg.go.dev/builtin/#error">error</a>)</pre>
			
			
			

		
			
			
			<h2 id="IsDirectlyFetchableMetric">func <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/file.go.html#L40">IsDirectlyFetchableMetric</a>
				<a class="permalink" href="#IsDirectlyFetchableMetric">&#xb6;</a>
				
				
			</h2>
			<pre>func IsDirectlyFetchableMetric(metric <a href="https://pkg.go.dev/builtin/#string">string</a>) <a href="https://pkg.go.dev/builtin/#bool">bool</a></pre>
			
			
			

		
			
			
			<h2 id="QueryMeasurements">func <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/database.go.html#L19">QueryMeasurements</a>
				<a class="permalink" href="#QueryMeasurements">&#xb6;</a>
				
				
			</h2>
			<pre>func QueryMeasurements(ctx <a href="https://pkg.go.dev/context/">context</a>.<a href="https://pkg.go.dev/context/#Context">Context</a>, md *<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/">sources</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/#SourceConn">SourceConn</a>, sql <a href="https://pkg.go.dev/builtin/#string">string</a>, args ...<a href="https://pkg.go.dev/builtin/#any">any</a>) (<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/metrics/">metrics</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/metrics/#Measurements">Measurements</a>, <a href="https://pkg.go.dev/builtin/#error">error</a>)</pre>
			
			
			

		
			
			
			<h2 id="TryCreateMetricsFetchingHelpers">func <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/database.go.html#L528">TryCreateMetricsFetchingHelpers</a>
				<a class="permalink" href="#TryCreateMetricsFetchingHelpers">&#xb6;</a>
				
				
			</h2>
			<pre>func TryCreateMetricsFetchingHelpers(ctx <a href="https://pkg.go.dev/context/">context</a>.<a href="https://pkg.go.dev/context/#Context">Context</a>, md *<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/">sources</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/#SourceConn">SourceConn</a>) (err <a href="https://pkg.go.dev/builtin/#error">error</a>)</pre>
			<p>Called once on daemon startup to try to create &quot;metric fething helper&quot; functions automatically

			
			

		
			
			
			<h2 id="TryCreateMissingExtensions">func <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/database.go.html#L490">TryCreateMissingExtensions</a>
				<a class="permalink" href="#TryCreateMissingExtensions">&#xb6;</a>
				
				
			</h2>
			<pre>func TryCreateMissingExtensions(ctx <a href="https://pkg.go.dev/context/">context</a>.<a href="https://pkg.go.dev/context/#Context">Context</a>, md *<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/">sources</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/#SourceConn">SourceConn</a>, extensionNames []<a href="https://pkg.go.dev/builtin/#string">string</a>, existingExtensions map[<a href="https://pkg.go.dev/builtin/#string">string</a>]<a href="https://pkg.go.dev/builtin/#int">int</a>) []<a href="https://pkg.go.dev/builtin/#string">string</a></pre>
			<p>Called once on daemon startup if some commonly wanted extension (most notably pg_stat_statements) is missing.
With newer Postgres version can even succeed if the user is not a real superuser due to some cloud-specific
whitelisting or &quot;trusted extensions&quot; (a feature from v13). Ignores errors.

			
			

		
			
			
			<h2 id="goPsutilCalcCPUUtilization">func <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/psutil.go.html#L23">goPsutilCalcCPUUtilization</a>
				<a class="permalink" href="#goPsutilCalcCPUUtilization">&#xb6;</a>
				
				
			</h2>
			<pre>func goPsutilCalcCPUUtilization(probe0, probe1 <a href="https://pkg.go.dev/github.com/shirou/gopsutil/v4/cpu/">cpu</a>.<a href="https://pkg.go.dev/github.com/shirou/gopsutil/v4/cpu/#TimesStat">TimesStat</a>) <a href="https://pkg.go.dev/builtin/#float64">float64</a></pre>
			
			
			

		
		
			
			
			<h2 id="ChangeDetectionResults">type <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/metric.go.html#L62">ChangeDetectionResults</a>
				<a class="permalink" href="#ChangeDetectionResults">&#xb6;</a>
				
				
			</h2>
			
			<pre>type ChangeDetectionResults struct {
<span id="ChangeDetectionResults.Target"></span>    Target  <a href="https://pkg.go.dev/builtin/#string">string</a>
<span id="ChangeDetectionResults.Created"></span>    Created <a href="https://pkg.go.dev/builtin/#int">int</a>
<span id="ChangeDetectionResults.Altered"></span>    Altered <a href="https://pkg.go.dev/builtin/#int">int</a>
<span id="ChangeDetectionResults.Dropped"></span>    Dropped <a href="https://pkg.go.dev/builtin/#int">int</a>
}
</pre>

			

			

			
			
			

			

			
				
				<h3 id="ChangeDetectionResults.String">func (*ChangeDetectionResults) <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/metric.go.html#L73">String</a>
					<a class="permalink" href="#ChangeDetectionResults.String">&#xb6;</a>
					
					
				</h3>
				<pre>func (cdr *<a href="#ChangeDetectionResults">ChangeDetectionResults</a>) String() <a href="https://pkg.go.dev/builtin/#string">string</a></pre>
				
				
				
				
			
				
				<h3 id="ChangeDetectionResults.Total">func (*ChangeDetectionResults) <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/metric.go.html#L69">Total</a>
					<a class="permalink" href="#ChangeDetectionResults.Total">&#xb6;</a>
					
					
				</h3>
				<pre>func (cdr *<a href="#ChangeDetectionResults">ChangeDetectionResults</a>) Total() <a href="https://pkg.go.dev/builtin/#int">int</a></pre>
				
				
				
				
			
		
			
			
			<h2 id="ConcurrentMetricDefs">type <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/metric.go.html#L21">ConcurrentMetricDefs</a>
				<a class="permalink" href="#ConcurrentMetricDefs">&#xb6;</a>
				
				
			</h2>
			
			<pre>type ConcurrentMetricDefs struct {
    *<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/metrics/">metrics</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/metrics/#Metrics">Metrics</a>
    <a href="https://pkg.go.dev/sync/">sync</a>.<a href="https://pkg.go.dev/sync/#RWMutex">RWMutex</a>
}
</pre>

			

			

			
			
			

			
				
				<h3 id="NewConcurrentMetricDefs">func <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/metric.go.html#L26">NewConcurrentMetricDefs</a>
					<a class="permalink" href="#NewConcurrentMetricDefs">&#xb6;</a>
					
					
				</h3>
				<pre>func NewConcurrentMetricDefs() *<a href="#ConcurrentMetricDefs">ConcurrentMetricDefs</a></pre>
				
				
				
			

			
				
				<h3 id="ConcurrentMetricDefs.Assign">func (*ConcurrentMetricDefs) <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/metric.go.html#L55">Assign</a>
					<a class="permalink" href="#ConcurrentMetricDefs.Assign">&#xb6;</a>
					
					
				</h3>
				<pre>func (cmd *<a href="#ConcurrentMetricDefs">ConcurrentMetricDefs</a>) Assign(newDefs *<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/metrics/">metrics</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/metrics/#Metrics">Metrics</a>)</pre>
				
				
				
				
			
				
				<h3 id="ConcurrentMetricDefs.GetMetricDef">func (*ConcurrentMetricDefs) <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/metric.go.html#L35">GetMetricDef</a>
					<a class="permalink" href="#ConcurrentMetricDefs.GetMetricDef">&#xb6;</a>
					
					
				</h3>
				<pre>func (cmd *<a href="#ConcurrentMetricDefs">ConcurrentMetricDefs</a>) GetMetricDef(name <a href="https://pkg.go.dev/builtin/#string">string</a>) (m <a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/metrics/">metrics</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/metrics/#Metric">Metric</a>, ok <a href="https://pkg.go.dev/builtin/#bool">bool</a>)</pre>
				
				
				
				
			
				
				<h3 id="ConcurrentMetricDefs.GetPresetDef">func (*ConcurrentMetricDefs) <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/metric.go.html#L42">GetPresetDef</a>
					<a class="permalink" href="#ConcurrentMetricDefs.GetPresetDef">&#xb6;</a>
					
					
				</h3>
				<pre>func (cmd *<a href="#ConcurrentMetricDefs">ConcurrentMetricDefs</a>) GetPresetDef(name <a href="https://pkg.go.dev/builtin/#string">string</a>) (m <a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/metrics/">metrics</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/metrics/#Preset">Preset</a>, ok <a href="https://pkg.go.dev/builtin/#bool">bool</a>)</pre>
				
				
				
				
			
				
				<h3 id="ConcurrentMetricDefs.GetPresetMetrics">func (*ConcurrentMetricDefs) <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/metric.go.html#L49">GetPresetMetrics</a>
					<a class="permalink" href="#ConcurrentMetricDefs.GetPresetMetrics">&#xb6;</a>
					
					
				</h3>
				<pre>func (cmd *<a href="#ConcurrentMetricDefs">ConcurrentMetricDefs</a>) GetPresetMetrics(name <a href="https://pkg.go.dev/builtin/#string">string</a>) (m map[<a href="https://pkg.go.dev/builtin/#string">string</a>]<a href="https://pkg.go.dev/builtin/#float64">float64</a>)</pre>
				
				
				
				
			
		
			
			
			<h2 id="ExistingPartitionInfo">type <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/metric.go.html#L77">ExistingPartitionInfo</a>
				<a class="permalink" href="#ExistingPartitionInfo">&#xb6;</a>
				
				
			</h2>
			
			<pre>type ExistingPartitionInfo struct {
<span id="ExistingPartitionInfo.StartTime"></span>    StartTime <a href="https://pkg.go.dev/time/">time</a>.<a href="https://pkg.go.dev/time/#Time">Time</a>
<span id="ExistingPartitionInfo.EndTime"></span>    EndTime   <a href="https://pkg.go.dev/time/">time</a>.<a href="https://pkg.go.dev/time/#Time">Time</a>
}
</pre>

			

			

			
			
			

			

			
		
			
			
			<h2 id="InstanceMetricCache">type <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/cache.go.html#L12">InstanceMetricCache</a>
				<a class="permalink" href="#InstanceMetricCache">&#xb6;</a>
				
				
			</h2>
			
			<pre>type InstanceMetricCache struct {
<span id="InstanceMetricCache.cache"></span>    cache map[<a href="https://pkg.go.dev/builtin/#string">string</a>](<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/metrics/">metrics</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/metrics/#Measurements">Measurements</a>) <span class="comment">// [dbUnique+metric]lastly_fetched_data</span>
    <a href="https://pkg.go.dev/sync/">sync</a>.<a href="https://pkg.go.dev/sync/#RWMutex">RWMutex</a>
}
</pre>

			

			

			
			
			

			
				
				<h3 id="NewInstanceMetricCache">func <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/cache.go.html#L17">NewInstanceMetricCache</a>
					<a class="permalink" href="#NewInstanceMetricCache">&#xb6;</a>
					
					
				</h3>
				<pre>func NewInstanceMetricCache() *<a href="#InstanceMetricCache">InstanceMetricCache</a></pre>
				
				
				
			

			
				
				<h3 id="InstanceMetricCache.Get">func (*InstanceMetricCache) <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/cache.go.html#L23">Get</a>
					<a class="permalink" href="#InstanceMetricCache.Get">&#xb6;</a>
					
					
				</h3>
				<pre>func (imc *<a href="#InstanceMetricCache">InstanceMetricCache</a>) Get(key <a href="https://pkg.go.dev/builtin/#string">string</a>, age <a href="https://pkg.go.dev/time/">time</a>.<a href="https://pkg.go.dev/time/#Duration">Duration</a>) <a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/metrics/">metrics</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/metrics/#Measurements">Measurements</a></pre>
				
				
				
				
			
				
				<h3 id="InstanceMetricCache.Put">func (*InstanceMetricCache) <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/cache.go.html#L41">Put</a>
					<a class="permalink" href="#InstanceMetricCache.Put">&#xb6;</a>
					
					
				</h3>
				<pre>func (imc *<a href="#InstanceMetricCache">InstanceMetricCache</a>) Put(key <a href="https://pkg.go.dev/builtin/#string">string</a>, data <a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/metrics/">metrics</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/metrics/#Measurements">Measurements</a>)</pre>
				
				
				
				
			
		
			
			
			<h2 id="Reaper">type <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/reaper.go.html#L34">Reaper</a>
				<a class="permalink" href="#Reaper">&#xb6;</a>
				
				
			</h2>
			<p>Reaper is the struct that responsible for fetching metrics measurements from the sources and storing them to the sinks

			<pre>type Reaper struct {
    *<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/cmdopts/">cmdopts</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/cmdopts/#Options">Options</a>
<span id="Reaper.ready"></span>    ready                <a href="https://pkg.go.dev/sync/atomic/">atomic</a>.<a href="https://pkg.go.dev/sync/atomic/#Bool">Bool</a>
<span id="Reaper.measurementCh"></span>    measurementCh        chan <a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/metrics/">metrics</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/metrics/#MeasurementEnvelope">MeasurementEnvelope</a>
<span id="Reaper.measurementCache"></span>    measurementCache     *<a href="#InstanceMetricCache">InstanceMetricCache</a>
<span id="Reaper.logger"></span>    logger               <a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/log/">log</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/log/#Logger">Logger</a>
<span id="Reaper.monitoredSources"></span>    monitoredSources     <a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/">sources</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/#SourceConns">SourceConns</a>
<span id="Reaper.prevLoopMonitoredDBs"></span>    prevLoopMonitoredDBs <a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/">sources</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/#SourceConns">SourceConns</a>
<span id="Reaper.cancelFuncs"></span>    cancelFuncs          map[<a href="https://pkg.go.dev/builtin/#string">string</a>]<a href="https://pkg.go.dev/context/">context</a>.<a href="https://pkg.go.dev/context/#CancelFunc">CancelFunc</a>
}
</pre>

			

			

			
			
			

			
				
				<h3 id="NewReaper">func <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/reaper.go.html#L46">NewReaper</a>
					<a class="permalink" href="#NewReaper">&#xb6;</a>
					
					
				</h3>
				<pre>func NewReaper(ctx <a href="https://pkg.go.dev/context/">context</a>.<a href="https://pkg.go.dev/context/#Context">Context</a>, opts *<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/cmdopts/">cmdopts</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/cmdopts/#Options">Options</a>) (r *<a href="#Reaper">Reaper</a>)</pre>
				<p>NewReaper creates a new Reaper instance

				
				
			

			
				
				<h3 id="Reaper.AddSysinfoToMeasurements">func (*Reaper) <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/reaper.go.html#L454">AddSysinfoToMeasurements</a>
					<a class="permalink" href="#Reaper.AddSysinfoToMeasurements">&#xb6;</a>
					
					
				</h3>
				<pre>func (r *<a href="#Reaper">Reaper</a>) AddSysinfoToMeasurements(data <a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/metrics/">metrics</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/metrics/#Measurements">Measurements</a>, md *<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/">sources</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/#SourceConn">SourceConn</a>)</pre>
				
				
				
				
			
				
				<h3 id="Reaper.CloseResourcesForRemovedMonitoredDBs">func (*Reaper) <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/database.go.html#L545">CloseResourcesForRemovedMonitoredDBs</a>
					<a class="permalink" href="#Reaper.CloseResourcesForRemovedMonitoredDBs">&#xb6;</a>
					
					
				</h3>
				<pre>func (r *<a href="#Reaper">Reaper</a>) CloseResourcesForRemovedMonitoredDBs(shutDownDueToRoleChange map[<a href="https://pkg.go.dev/builtin/#string">string</a>]<a href="https://pkg.go.dev/builtin/#bool">bool</a>)</pre>
				
				
				
				
			
				
				<h3 id="Reaper.CreateSourceHelpers">func (*Reaper) <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/reaper.go.html#L209">CreateSourceHelpers</a>
					<a class="permalink" href="#Reaper.CreateSourceHelpers">&#xb6;</a>
					
					
				</h3>
				<pre>func (r *<a href="#Reaper">Reaper</a>) CreateSourceHelpers(ctx <a href="https://pkg.go.dev/context/">context</a>.<a href="https://pkg.go.dev/context/#Context">Context</a>, srcL <a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/log/">log</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/log/#Logger">Logger</a>, monitoredSource *<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/">sources</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/#SourceConn">SourceConn</a>)</pre>
				<p>CreateSourceHelpers creates the extensions and metric helpers for the monitored source

				
				
				
			
				
				<h3 id="Reaper.DetectConfigurationChanges">func (*Reaper) <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/database.go.html#L379">DetectConfigurationChanges</a>
					<a class="permalink" href="#Reaper.DetectConfigurationChanges">&#xb6;</a>
					
					
				</h3>
				<pre>func (r *<a href="#Reaper">Reaper</a>) DetectConfigurationChanges(ctx <a href="https://pkg.go.dev/context/">context</a>.<a href="https://pkg.go.dev/context/#Context">Context</a>, md *<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/">sources</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/#SourceConn">SourceConn</a>) <a href="#ChangeDetectionResults">ChangeDetectionResults</a></pre>
				
				
				
				
			
				
				<h3 id="Reaper.DetectIndexChanges">func (*Reaper) <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/database.go.html#L214">DetectIndexChanges</a>
					<a class="permalink" href="#Reaper.DetectIndexChanges">&#xb6;</a>
					
					
				</h3>
				<pre>func (r *<a href="#Reaper">Reaper</a>) DetectIndexChanges(ctx <a href="https://pkg.go.dev/context/">context</a>.<a href="https://pkg.go.dev/context/#Context">Context</a>, md *<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/">sources</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/#SourceConn">SourceConn</a>) <a href="#ChangeDetectionResults">ChangeDetectionResults</a></pre>
				
				
				
				
			
				
				<h3 id="Reaper.DetectPrivilegeChanges">func (*Reaper) <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/database.go.html#L297">DetectPrivilegeChanges</a>
					<a class="permalink" href="#Reaper.DetectPrivilegeChanges">&#xb6;</a>
					
					
				</h3>
				<pre>func (r *<a href="#Reaper">Reaper</a>) DetectPrivilegeChanges(ctx <a href="https://pkg.go.dev/context/">context</a>.<a href="https://pkg.go.dev/context/#Context">Context</a>, md *<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/">sources</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/#SourceConn">SourceConn</a>) <a href="#ChangeDetectionResults">ChangeDetectionResults</a></pre>
				
				
				
				
			
				
				<h3 id="Reaper.DetectSprocChanges">func (*Reaper) <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/database.go.html#L50">DetectSprocChanges</a>
					<a class="permalink" href="#Reaper.DetectSprocChanges">&#xb6;</a>
					
					
				</h3>
				<pre>func (r *<a href="#Reaper">Reaper</a>) DetectSprocChanges(ctx <a href="https://pkg.go.dev/context/">context</a>.<a href="https://pkg.go.dev/context/#Context">Context</a>, md *<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/">sources</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/#SourceConn">SourceConn</a>) (changeCounts <a href="#ChangeDetectionResults">ChangeDetectionResults</a>)</pre>
				
				
				
				
			
				
				<h3 id="Reaper.DetectTableChanges">func (*Reaper) <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/database.go.html#L130">DetectTableChanges</a>
					<a class="permalink" href="#Reaper.DetectTableChanges">&#xb6;</a>
					
					
				</h3>
				<pre>func (r *<a href="#Reaper">Reaper</a>) DetectTableChanges(ctx <a href="https://pkg.go.dev/context/">context</a>.<a href="https://pkg.go.dev/context/#Context">Context</a>, md *<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/">sources</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/#SourceConn">SourceConn</a>) <a href="#ChangeDetectionResults">ChangeDetectionResults</a></pre>
				
				
				
				
			
				
				<h3 id="Reaper.FetchMetric">func (*Reaper) <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/reaper.go.html#L465">FetchMetric</a>
					<a class="permalink" href="#Reaper.FetchMetric">&#xb6;</a>
					
					
				</h3>
				<pre>func (r *<a href="#Reaper">Reaper</a>) FetchMetric(ctx <a href="https://pkg.go.dev/context/">context</a>.<a href="https://pkg.go.dev/context/#Context">Context</a>, md *<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/">sources</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/#SourceConn">SourceConn</a>, metricName <a href="https://pkg.go.dev/builtin/#string">string</a>) (_ *<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/metrics/">metrics</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/metrics/#MeasurementEnvelope">MeasurementEnvelope</a>, err <a href="https://pkg.go.dev/builtin/#error">error</a>)</pre>
				
				
				
				
			
				
				<h3 id="Reaper.FetchStatsDirectlyFromOS">func (*Reaper) <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/file.go.html#L44">FetchStatsDirectlyFromOS</a>
					<a class="permalink" href="#Reaper.FetchStatsDirectlyFromOS">&#xb6;</a>
					
					
				</h3>
				<pre>func (r *<a href="#Reaper">Reaper</a>) FetchStatsDirectlyFromOS(ctx <a href="https://pkg.go.dev/context/">context</a>.<a href="https://pkg.go.dev/context/#Context">Context</a>, md *<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/">sources</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/#SourceConn">SourceConn</a>, metricName <a href="https://pkg.go.dev/builtin/#string">string</a>) (*<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/metrics/">metrics</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/metrics/#MeasurementEnvelope">MeasurementEnvelope</a>, <a href="https://pkg.go.dev/builtin/#error">error</a>)</pre>
				
				
				
				
			
				
				<h3 id="Reaper.GetInstanceUpMeasurement">func (*Reaper) <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/database.go.html#L453">GetInstanceUpMeasurement</a>
					<a class="permalink" href="#Reaper.GetInstanceUpMeasurement">&#xb6;</a>
					
					
				</h3>
				<pre>func (r *<a href="#Reaper">Reaper</a>) GetInstanceUpMeasurement(ctx <a href="https://pkg.go.dev/context/">context</a>.<a href="https://pkg.go.dev/context/#Context">Context</a>, md *<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/">sources</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/#SourceConn">SourceConn</a>) (<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/metrics/">metrics</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/metrics/#Measurements">Measurements</a>, <a href="https://pkg.go.dev/builtin/#error">error</a>)</pre>
				<p>GetInstanceUpMeasurement returns a single measurement with &quot;instance_up&quot; metric
used to detect if the instance is up or down

				
				
				
			
				
				<h3 id="Reaper.GetObjectChangesMeasurement">func (*Reaper) <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/database.go.html#L468">GetObjectChangesMeasurement</a>
					<a class="permalink" href="#Reaper.GetObjectChangesMeasurement">&#xb6;</a>
					
					
				</h3>
				<pre>func (r *<a href="#Reaper">Reaper</a>) GetObjectChangesMeasurement(ctx <a href="https://pkg.go.dev/context/">context</a>.<a href="https://pkg.go.dev/context/#Context">Context</a>, md *<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/">sources</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/#SourceConn">SourceConn</a>) (<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/metrics/">metrics</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/metrics/#Measurements">Measurements</a>, <a href="https://pkg.go.dev/builtin/#error">error</a>)</pre>
				
				
				
				
			
				
				<h3 id="Reaper.LoadMetrics">func (*Reaper) <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/metric.go.html#L83">LoadMetrics</a>
					<a class="permalink" href="#Reaper.LoadMetrics">&#xb6;</a>
					
					
				</h3>
				<pre>func (r *<a href="#Reaper">Reaper</a>) LoadMetrics() (err <a href="https://pkg.go.dev/builtin/#error">error</a>)</pre>
				<p>LoadMetrics loads metric definitions from the reader

				
				
				
			
				
				<h3 id="Reaper.LoadSources">func (*Reaper) <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/reaper.go.html#L375">LoadSources</a>
					<a class="permalink" href="#Reaper.LoadSources">&#xb6;</a>
					
					
				</h3>
				<pre>func (r *<a href="#Reaper">Reaper</a>) LoadSources() (err <a href="https://pkg.go.dev/builtin/#error">error</a>)</pre>
				<p>LoadSources loads sources from the reader

				
				
				
			
				
				<h3 id="Reaper.PrintMemStats">func (*Reaper) <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/reaper.go.html#L63">PrintMemStats</a>
					<a class="permalink" href="#Reaper.PrintMemStats">&#xb6;</a>
					
					
				</h3>
				<pre>func (r *<a href="#Reaper">Reaper</a>) PrintMemStats()</pre>
				
				
				
				
			
				
				<h3 id="Reaper.Ready">func (*Reaper) <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/reaper.go.html#L59">Ready</a>
					<a class="permalink" href="#Reaper.Ready">&#xb6;</a>
					
					
				</h3>
				<pre>func (r *<a href="#Reaper">Reaper</a>) Ready() <a href="https://pkg.go.dev/builtin/#bool">bool</a></pre>
				<p>Ready() returns true if the service is healthy and operating correctly

				
				
				
			
				
				<h3 id="Reaper.Reap">func (*Reaper) <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/reaper.go.html#L78">Reap</a>
					<a class="permalink" href="#Reaper.Reap">&#xb6;</a>
					
					
				</h3>
				<pre>func (r *<a href="#Reaper">Reaper</a>) Reap(ctx <a href="https://pkg.go.dev/context/">context</a>.<a href="https://pkg.go.dev/context/#Context">Context</a>)</pre>
				<p>Reap() starts the main monitoring loop. It is responsible for fetching metrics measurements
from the sources and storing them to the sinks. It also manages the lifecycle of
the metric gatherers. In case of a source or metric definition change, it will
start or stop the gatherers accordingly.

				
				
				
			
				
				<h3 id="Reaper.ShutdownOldWorkers">func (*Reaper) <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/reaper.go.html#L235">ShutdownOldWorkers</a>
					<a class="permalink" href="#Reaper.ShutdownOldWorkers">&#xb6;</a>
					
					
				</h3>
				<pre>func (r *<a href="#Reaper">Reaper</a>) ShutdownOldWorkers(ctx <a href="https://pkg.go.dev/context/">context</a>.<a href="https://pkg.go.dev/context/#Context">Context</a>, hostsToShutDownDueToRoleChange map[<a href="https://pkg.go.dev/builtin/#string">string</a>]<a href="https://pkg.go.dev/builtin/#bool">bool</a>)</pre>
				
				
				
				
			
				
				<h3 id="Reaper.WriteMeasurements">func (*Reaper) <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/reaper.go.html#L440">WriteMeasurements</a>
					<a class="permalink" href="#Reaper.WriteMeasurements">&#xb6;</a>
					
					
				</h3>
				<pre>func (r *<a href="#Reaper">Reaper</a>) WriteMeasurements(ctx <a href="https://pkg.go.dev/context/">context</a>.<a href="https://pkg.go.dev/context/#Context">Context</a>)</pre>
				<p>WriteMeasurements() writes the metrics to the sinks

				
				
				
			
				
				<h3 id="Reaper.WriteMonitoredSources">func (*Reaper) <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/reaper.go.html#L412">WriteMonitoredSources</a>
					<a class="permalink" href="#Reaper.WriteMonitoredSources">&#xb6;</a>
					
					
				</h3>
				<pre>func (r *<a href="#Reaper">Reaper</a>) WriteMonitoredSources(ctx <a href="https://pkg.go.dev/context/">context</a>.<a href="https://pkg.go.dev/context/#Context">Context</a>)</pre>
				<p>WriteMonitoredSources writes actively monitored DBs listing to sinks
every monitoredDbsDatastoreSyncIntervalSeconds (default 10min)

				
				
				
			
				
				<h3 id="Reaper.reapMetricMeasurements">func (*Reaper) <a href="/devel/godoc/src/github.com/cybertec-postgresql/pgwatch/v3/internal/reaper/reaper.go.html#L282">reapMetricMeasurements</a>
					<a class="permalink" href="#Reaper.reapMetricMeasurements">&#xb6;</a>
					
					
				</h3>
				<pre>func (r *<a href="#Reaper">Reaper</a>) reapMetricMeasurements(ctx <a href="https://pkg.go.dev/context/">context</a>.<a href="https://pkg.go.dev/context/#Context">Context</a>, md *<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/">sources</a>.<a href="/devel/godoc/pkg/github.com/cybertec-postgresql/pgwatch/v3/internal/sources/#SourceConn">SourceConn</a>, metricName <a href="https://pkg.go.dev/builtin/#string">string</a>)</pre>
				
				
				
				
			
		
	

	







<div id="footer">
Build version go1.25.1.<br>
</div>

</div><!-- .container -->
</div><!-- #page -->
</body>
</html>
